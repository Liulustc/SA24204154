<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Lei Liu" />

<meta name="date" content="2024-12-08" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Lei Liu</h4>
<h4 class="date">2024-12-08</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="example-1." class="section level2">
<h2>Example 1.</h2>
<p>作出正弦函数的例图。 <span class="math display">\[y=\sin(x),\quad
x\in(0,2\pi)\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制正弦曲线</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;正弦函数 y = sin(x)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2." class="section level2">
<h2>Example 2.</h2>
<p>利用正态随机分布生成6个同学A,…,F的语文数学英语成绩，结果保留一位小数输出为表格。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Chinese_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Math_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)     </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>English_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(Chinese_scores, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 74.4 77.7 95.6 80.7 81.3 97.2</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(Math_scores, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 84.6 67.3 73.1 75.5 92.2 83.6</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(English_scores, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 84.0 81.1 74.4 97.9 85.0 60.3</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">学生</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">E</th>
<th align="center">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">语文</td>
<td align="center">74.4</td>
<td align="center">77.7</td>
<td align="center">95.6</td>
<td align="center">80.7</td>
<td align="center">81.3</td>
<td align="center">97.2</td>
</tr>
<tr class="even">
<td align="center">数学</td>
<td align="center">84.6</td>
<td align="center">67.3</td>
<td align="center">73.1</td>
<td align="center">75.5</td>
<td align="center">92.2</td>
<td align="center">83.6</td>
</tr>
<tr class="odd">
<td align="center">英语</td>
<td align="center">84.0</td>
<td align="center">81.1</td>
<td align="center">74.4</td>
<td align="center">97.9</td>
<td align="center">85.0</td>
<td align="center">60.3</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3." class="section level2">
<h2>Example 3.</h2>
<p>画出<span class="math inline">\(y=x^n,\quad
n=-1,\frac12,2\)</span>的图像</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义x的范围</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)  <span class="co"># 避免x为0</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n=2时</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, x<span class="sc">^</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="at">main=</span><span class="st">&quot;y = x^n, n = -1, 1/2, 2&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加n=1/2和-1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, x<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;pink&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)  <span class="co"># n = -1</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">col=</span><span class="st">&quot;lightgreen&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)  <span class="co"># n = 1/2</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;n = -1&quot;</span>, <span class="st">&quot;n = 1/2&quot;</span>, <span class="st">&quot;n = 2&quot;</span>), </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;skyblue&quot;</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="section" class="section level2">
<h2>1</h2>
<p>The Rayleigh density is</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2 \sigma^2\right)}, \quad x \geq
0, \sigma&gt;0
\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution. Generate Rayleigh
<span class="math inline">\((\sigma)\)</span> samples for several
choices of <span class="math inline">\(\sigma&gt;0\)</span> and check
that the mode of the generated samples is close to the theoretical mode
<span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<p>solution:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(U\sim U(0,1)\)</span></p></li>
<li><p><span class="math inline">\(X\sim F_X^{-1}(U)=\sigma\sqrt{-2\ln
(1-U)}\)</span>，即<span class="math inline">\(X\sim \sigma\sqrt{-2\ln
U}\)</span></p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>generate_Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="fu">generate_Rayleigh</span>(n, sigma)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rayleigh, <span class="at">prob =</span> <span class="st">&quot;T&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Rayleigh 分布 (σ =&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>),<span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(rayleigh), <span class="at">length =</span> <span class="dv">10000</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>f_x <span class="ot">&lt;-</span> (x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#理论函数图像</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f_x, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> sigma, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAzFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtraQttuQ27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2tma2tpC2tra225C229u22/+2///T09PbkDrbkGbbtmbbtpDbtrbb27bb29vb2//b////AAD/tmb/25D/27b/29v//7b//9v///+IQj0fAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM9klEQVR4nO2dC3vbthWGKXvWpCzOZVKStVXm7ma66bw5YtfGEylP0v//T8ONNwnEB5AgCdnne57IEQWCwMuDA4A8BKMDyaho7AKELgIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECCh0QL/dbw53b25r27af3m0GK4AXQPvPkdDkzYMhyXRj+H44JNGkzkElm21+OQKURRfHKXdLzc56xeWBt/OLryi5V0CRro5FkjaARBW214vaxjiS3x8fKztP7YxqfxeVSVkhFsbUB++AollzElAFLSDJ4u6NOtG/3TP9PJ98x/9+iaL3Ze6wpkK/fowqgGy4+gIkDrSdi7+iFKxZ8PbBf86iaKWS8BM4eb8pduHfr27jiNkJA/QP8a2SsWoD23m1HskpjEzC3X+Zq/O0ULsfGXbC/juvQGEJVqBuXgHJ9p0VhUoiUT9ef5lktxQ/XX1Vu0jTm7yWgKQqboH9vFIVKyu1W158za7f1868PFDFkBsBXf37cy0vaHn+LYh9+f2G/3ehThArxUwlYage5E/yO2M52+zjSAGaPvDPssiFrbAkv/tBbeStLqs3ZWWqYt8nRim3ihNAv7zf1Nt6DNuYbx8ka/Tty+tIUpnJFiaBqBOWFBYl2hYnKAGt6uc0i67+yp3N/T8/vWb5SaNhlf7u/qdoyjZe5yDEKVCfPEGTI1RlrQFC/ZhnQDPuV24Kfy1MP1aNabqpnFHxPS9s7oNui1pyba+/38hWxltV5VArYUGVjcIm1SfqDuo/a3uGmrwCuvqb+nL1l2+ioryNSZsQ5cqiOqCchhbQ/vG/BzXAqbC4Yw6rGdCqTuCkiR3GA8TM4SfZgcrSyoryNibLkFvQqraL0YJUHaebyoDubnKbYAualdsDAiScZO5y8tImvIua5t16pfY6H6QDlMiqqzp9YUP1uAlQ6YMW5fagALGys8KLroz3JbO8iKVniKPJD4enZWE89V5MA0hOITJVp/3j5qADpHbKezGj3x3LSefdvOifykE1/yKKUBsHTW614yANINnR13p1CWh6/63mufODmaY7tbLmmQ3VzecDRd6533B3rQaJmZp9qCRPN8yk3j3URtJvHxp9UDbn3WJ97Kws6NfqiFgNJMVIunnCXC+r+jLIQNGgLIKD+ebz+J9X3zOmH1+fGAU3qf89birfrSfzNW3ncL+eAT19NDbyWMw3G4Z2TzfvhDHsb94c1+J4OlbMSRyVwRbWLyDhckw2nJ32Mu2UGEfPjYrxRYC+AU3+aEzx9Il5jck7s9uwOhK+9HWqwS6YPWcRICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECcgMU86DcuYf7WOcjJ0CCzytxB73VjcxzlAug3XLBIIlbmIll3Pb5yw0QD8YUN2uzNjcyz1JuTYzHZZIFNYvfARcmlL0cL+3YzWfmJzKeoWgcBESAgFoCSlr3YqKJppdp2nL/oeXHgopHNXB20XqdpullxD5sko8uz0W0AMTIrNeXa8GJAGlSMDwSEEfk9+h9yA1QHiTe6IFwdmkF0DkQcgJURN9mTdGhMDvJZx1JQFH4hFwAqXkYV9NUA2XH3E4N0OFZAapc5GiarEJAh2NAoRMa1oLSHNBlDih4Qo4+SJlQGx8kBojs3xGg0BuZWy+mHmdqfsLBBIh3WnnjqgIKm9Bw4yAOaK0BFDihIQGlp4DkzCzkAfWggMr+K+/Fwh8uDggobQK0JkDip+oY+ghQwIRGAnRZAxQRIKZ0bQCU2l1MGkHDXTAzAVL+20tZPGswC0rNgFICFJkArQlQHVB0Aih94YBSAGj94gEdEKCUAJl8EDehlwpIzEfTCAIKc85aFOp4ZaOO2VW3KQ8DAK0DByTWJ7Jcz9Iqu3KbLaAgJxz1GnVm1AAotQEU5qT+uEaJ6bage3ZiW/VSYmMvFqoJ1WrEw6N4GGL7+LpOgIKc1Jc14hfkJZkOEZodAQVIqNKL+Yg71ANKTwBpfVCQ91lLQB8kn24Bvg2ATmA0AQqP0Amg9rFjteyq2+wBBWhCqkZxecmrTTdvvGBWu1p/roBKC/KUXXVbegqjEVBwhIaYi2kA6XuxQ4AmFByg0AjJGu2Wizwuocs4Wg8otQakAkA6HN+/BrCgVAND74P4R2hXPYIDFNpVj+pUYyHeTADnYZnhkUwfgMLyQmWNYr6k+kw9UdggNlxabN9umh/J1ABKHQEFdtWjMhfjyzSvjFONmC8qLqzHIUYx1VE4U0D8oV3DVEPYjXio1yXKVQtI34utA2xjlSY22y35uvzNTUw81HvY87c5dLUgE6CwLgvVrgfx112YXFBhXRKVMbtcaQtAIRFy61MT2X1ljet/awAdXH1QWJeFeh8HtQIUEKGyRvBJHrfscrUBFJIJVZy0C5mmvu4EUNoOUDiEKt18hxtizRfM0oM7oKCmrLVxkMfscjUAMvZi65CmrEU5zB28c3a5WgIKZ8palqO57y7l9kimiupoBygUL1SN7oC9mOMjmZHmjqGNDxKfwQGykOsDdd0ABULIBZDrI5mdAIUyI6vUaMdfjBYbOvtBLSiUGVnFSU9uEz6bNxByfCRTd1PeHlAgw+lKN78QdmG89ez2SKbunrNtLxbMjKw2UOSAPAYvdAQUhgmdWFDcaXUyv4BCIHTsg5J2r3o7ze6gj1pw8EFhmFC9F+u8xuYRoMbqWwIKgFCfF8y6AQpkUh8uIP4RwKT+aC7Wdf1Iz4ACmNTnBYilcz5+P6dtLtoLZrqwDvteTAIa3QupGhVLa27n/nox3T1nR0DjE5I1qlwtM96bt8xOyQeg0eesRQBVvsFjlKsBkK0PGn/OmgOCFzJcslPyAmjs0WKPgLRxLy0AjUuoT0CG6jsAGplQ8IDUwl4dytRNOaByJDMIIPtebD3yA9E9TjW8ARp1xtEfIH1gUCtAY844egSkvaXq7IMkoPH89HkAGpHQmQAabwmmcwE02hJMvQFqCOtoD2ikFYZGAuTYi/E/I60w5OeQmgtm3gGNNF48HwsaabzYCyBD5FRrHyQJ+S2tfY08Zxc1h3V0AjQGofMCNML1xTMDpAaMfgttUSPP2fUHSLzPZdDOzO1YllGuhsipLr3YKJ2Z07Fso1wNcS8eAA3rqnuJcu0ZEG9mnSrtol6iXDGg9j5I/Bnw5VsjWVBHQOvhXr7l6IPsolwNoWXeAA3V0NzOgmWUqyHuxSMgPmzsn1E/46CBAIk5X8+MRgLUrRerJ0yF+nJILfM1P5I5LCDxmeZqC6JJvVwwU1fYx1CK5Do4GOmO3OU4h20hAgTkebJqq8uO+w8nz5NVW112231AeZ5qqEyhLvt11YXagynq4pDWOswKZ+ojhZ9MfGZhb0EeDnuOgCwmq7aZPlNAeLJqm+lzBeQtUwI0QAoCNEgmA2TRJlMCNECKMwb0nESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBA/gGZ3kuSa/sH451HcX8S3HlLbFbL6rYgm5B3QHwdmQwUfbc03jXaf2b7J+YXB/PwEnQYdq7CAyRvDZmXkMnAvWu5RA9Y0HGBV3gWS4saU1jINyCLymXRwmZ5B2gfEFAy/XOAgIwvbsllAwivsZ+YEbKiBOiD5HlHZ98CEIyPyIAf5439GQPKLF7ubn7ncvdlRYUCbWJ28TWm8yAKEiIg7KQPGJDlYnymFekSFQDT9V0PY3TzEBBeUFaigYYYoAVZDRRBzbZzbD+86pVwHEOqjvI/1bCZA5gBqdZhziW2aT5BAnpmIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAgobECV5VRq/69/6VXnA8juB+8iQEDBANp9+JFHT6uoFhGBlcwEh0SG3Usm7PfJj5Pb3fJP8+7RYzYKB9CSx/JwMDy6lwcQ7T+vOBT+lYdUCUA8NjiLOCAejN/xzd1WCggQt5IPtzK8jtPYvmIcVvINpwyY2CQi72IOaNH5pbl2CghQsXiTamPJdMM2ynA+xoInkJFpGQe0GsgRBQaI+ZuLf3HDYChi0ayyPFpVNLeXDkg0GvGx+/B31twKC1IJXrwFCQAZb2L7z9fMaQsftCoTqCjslwtI+mcRRZ7kXbvoq2LFpOzFXiYgGUMccyTiUYJiHMS4FOOgi59ll/bCAB1r+7YxxLnby4QdFSygRBdFL/33suNCsk4KFNB2ro+Rz3w8n+KkQAGFIwIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQL6P2uYYJivyjsOAAAAAElFTkSuQmCC" /><!-- --></p>
<p>从图上可以看出生成样本的总数接近理论众数。</p>
</div>
<div id="section-1" class="section level2">
<h2>2</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing
probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1=0.75\)</span>. Repeat with different values
for <span class="math inline">\(p_1\)</span> and observe whether the
empirical distribution of the mixture appears to be bimodal. Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<p>solution:</p>
<p>生成不同<span class="math inline">\(p_1\)</span>值的正态混合分布样本并绘图</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>generate_Mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p1){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 生成0 1,0代表N(0,1), 1代表N(3,1)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  mix <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p1)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mix <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>))  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>p1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.5</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>)  </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_values) {</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_Mixture</span>(n, p1)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;正态混合分布 (p1 =&quot;</span>, p1, <span class="st">&quot;)&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;密度&quot;</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(samples), <span class="fu">max</span>(samples), <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  f_x <span class="ot">&lt;-</span> p1 <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, f_x, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以观察到，<span class="math inline">\(p_1\)</span>接近0.5时表现为双峰，过大过小时，一个分布影响更大，表现为单峰。</p>
</div>
<div id="section-2" class="section level2">
<h2>3</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be
represented as the random <span class="math inline">\(\operatorname{sum}
X(t)=\sum_{i=1}^{N(t)} Y_i, t \geq 0\)</span>, where <span class="math inline">\(\{N(t), t \geq 0\}\)</span> is a Poisson process
and <span class="math inline">\(Y_1, Y_2, \ldots\)</span> are iid and
independent of <span class="math inline">\(\{N(t), t \geq 0\}\)</span>.
Write a program to simulate a compound Poisson <span class="math inline">\((\lambda)\)</span>-Gamma process ( <span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda t
E\left[Y_1\right]\)</span> and <span class="math inline">\(\operatorname{Var}(X(t))=\lambda t
E\left[Y_1^2\right]\)</span></p>
<p>solution:</p>
<p>理论结果： <span class="math inline">\(Y_i\sim gamma(\alpha,\beta),
EY_i=\frac{\alpha}{\beta},
EY_i^2=\frac{\alpha}{\beta^2}+(\frac{\alpha}{\beta})^2\)</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>generate_Poisson_Gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t){</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, alpha, beta) </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    X_t <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    X_t <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X_t)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>    </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>X_t_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    X_t_values[i] <span class="ot">&lt;-</span> <span class="fu">generate_Poisson_Gamma</span>(lambda, alpha, beta, t)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 理论结果</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>mean1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> beta)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">*</span> (alpha <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 实验结果</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>mean2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t_values)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t_values)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模拟均值: &quot;</span>, mean2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模拟均值:  40.19637</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论均值: &quot;</span>, mean1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论均值:  40</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模拟方差: &quot;</span>, var2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模拟方差:  118.6715</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论方差: &quot;</span>, var1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论方差:  120</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X_t_values, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;复合泊松-伽玛过程&quot;</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X(t)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="section-3" class="section level2">
<h2>5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9.
Compare the estimates with the values returned by the pbeta function in
R.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10000</span>){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(beta_samples <span class="sc">&lt;=</span> x)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(estimate)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># monte carlo</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>monte_carlo_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, beta)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># pbeta</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>pbeta_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, monte_carlo_estimates, pbeta_values)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##     x monte_carlo_estimates pbeta_values
## 1 0.1                0.0087      0.00856
## 2 0.2                0.0571      0.05792
## 3 0.3                0.1723      0.16308
## 4 0.4                0.3249      0.31744
## 5 0.5                0.4987      0.50000
## 6 0.6                0.6847      0.68256
## 7 0.7                0.8410      0.83692
## 8 0.8                0.9404      0.94208
## 9 0.9                0.9931      0.99144</code></pre>
</div>
<div id="section-4" class="section level2">
<h2>5.9</h2>
<p>The Rayleigh density is <span class="math display">\[
f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2 \sigma^2\right)}, \quad x \geq
0, \sigma&gt;0
\]</span> Implement a function to generate samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> compared with
<span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent
<span class="math inline">\(X_1, X_2\)</span> ?</p>
<p>solution:</p>
<p>先生成均匀分布的随机变量 <span class="math inline">\(U\)</span>
，再计算 <span class="math inline">\(X=\sigma \sqrt{-2 \ln (U)}\)</span>
和 <span class="math inline">\(X^{\prime}=\sigma \sqrt{-2 \ln
(1-U)}\)</span> ，接着计算这两个变量的平均值 <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> 。</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 对偶变量法</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  X_prime <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((X <span class="sc">+</span> X_prime) <span class="sc">/</span> <span class="dv">2</span>)  </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 对偶</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>samples_1 <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(sigma, n)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 独立</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>samples_2_1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>samples_2_2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>var_1 <span class="ot">&lt;-</span> <span class="fu">var</span>(samples_1)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_1)</span></code></pre></div>
<pre><code>## [1] 0.01172088</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>var_2 <span class="ot">&lt;-</span> (<span class="fu">var</span>(samples_2_1) <span class="sc">+</span> <span class="fu">var</span>(samples_2_2)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_2)</span></code></pre></div>
<pre><code>## [1] 0.4289715</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差缩减百分比</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>var_reduce <span class="ot">&lt;-</span> (var_2 <span class="sc">-</span> var_1) <span class="sc">/</span> var_2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_reduce)</span></code></pre></div>
<pre><code>## [1] 97.26768</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1
\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
<p>solution:</p>
<p>考虑重要性函数:</p>
<ol style="list-style-type: decimal">
<li>重要性函数 <span class="math inline">\(f_1\)</span> : <span class="math display">\[
f_1(x)=C_1 \cdot e^{-x}, \quad x&gt;1
\]</span></li>
</ol>
<p>其中 <span class="math inline">\(C_1\)</span> 是归—化常数，使得 <span class="math inline">\(\int_1^{\infty} f_1(x) d x=1\)</span> 。</p>
<ol start="2" style="list-style-type: decimal">
<li>重要性函数 <span class="math inline">\(f_2\)</span> : <span class="math display">\[
f_2(x)=C_2 \cdot x e^{-x}, \quad x&gt;1
\]</span></li>
</ol>
<p>这里同样 <span class="math inline">\(C_2\)</span> 是归一化常数。</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># g(x)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 求C1和C2的值</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x), <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">integrate</span>(<span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x), <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 重要性函数 f1 和 f2</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  C1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  C2 <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算方差</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>var_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(f, g, n) {</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span>  </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">g</span>(samples) <span class="sc">/</span> <span class="fu">f</span>(samples)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">var</span>(weights))</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>var_f1 <span class="ot">&lt;-</span> <span class="fu">var_estimate</span>(f1, g, n)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>var_f2 <span class="ot">&lt;-</span> <span class="fu">var_estimate</span>(f2, g, n)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_f1)</span></code></pre></div>
<pre><code>## [1] 0.02467938</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_f2)</span></code></pre></div>
<pre><code>## [1] 0.03733331</code></pre>
<p>f1和g的形状更相似，在x&gt;1
的区域较好地平衡了样本的分布和目标函数的衰减，从而导致了较小的方差。</p>
</div>
<div id="monte-carlo-experiment" class="section level2">
<h2>Monte Carlo experiment</h2>
<ul>
<li><p>For <span class="math inline">\(n=10^4, 2 \times 10^4, 4 \times
10^4, 6 \times 10^4, 8 \times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,
\ldots, n\)</span>.</p></li>
<li><p>Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n \log (n)\)</span>, and graphically show the
results (scatter plot and regression line).</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 快速排序</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fast_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  pivot_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">1</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> x[pivot_index]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  left <span class="ot">&lt;-</span> x[x <span class="sc">&lt;</span> pivot]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  right <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> pivot]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">fast_sort</span>(left), pivot, <span class="fu">fast_sort</span>(right)))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算平均时间</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>compute_average_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">simulations =</span> <span class="dv">100</span>) {</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(simulations)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    numbers <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 开始时间</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    sorted_numbers <span class="ot">&lt;-</span> <span class="fu">fast_sort</span>(numbers)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 结束时间</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 时间差</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    times[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(end_time <span class="sc">-</span> start_time, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(times))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>average_times <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_values, compute_average_time)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co">#  t_n = n log(n)</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 回归分析</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(average_times <span class="sc">~</span> t_n)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = average_times ~ t_n)
## 
## Residuals:
##          1          2          3          4          5 
## -0.0052282  0.0001593  0.0170640 -0.0166666  0.0046715 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.736e-02  1.175e-02   2.329 0.102268    
## t_n         5.839e-07  2.160e-08  27.032 0.000111 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01435 on 3 degrees of freedom
## Multiple R-squared:  0.9959, Adjusted R-squared:  0.9945 
## F-statistic: 730.7 on 1 and 3 DF,  p-value: 0.0001111</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制散点图和回归线</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_n, average_times, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;平均计算时间与 n log(n) 的关系&quot;</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t_n = n log(n)&quot;</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;平均计算时间 (秒)&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="section-6" class="section level2">
<h2>6.6</h2>
<p>Estimate the <span class="math inline">\(0.025,0.05,0.95\)</span>,
and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte
Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}
\approx N(0,6 / n)\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co"># 样本大小</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>   <span class="co"># 模拟次数</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co"># 偏度</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_data)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (sample_sd <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    b1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>((sample_data <span class="sc">-</span> <span class="fu">mean</span>(sample_data))<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> (n <span class="sc">*</span> sample_sd<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    b1[i] <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 删除NA值</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(b1)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(b1, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出蒙特卡洛结果</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(quantiles)</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1502697 -0.1254933  0.1273015  0.1502312</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出理论结果</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>se_sqrt_b1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出标准误差</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(se_sqrt_b1)</span></code></pre></div>
<pre><code>## [1] 0.07745967</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>theoretical_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(theoretical_quantiles)</span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
</div>
<div id="b" class="section level2">
<h2>6.B</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in cor.test. Show (empirically) that the nonparametric tests based on
<span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<p>solution:</p>
<p>例子如二元正态分布，参数为<span class="math inline">\(\mu=\binom{0}{0},\Sigma=\binom{1,\quad0.3}{0.3,\quad6}\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>      </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>      </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 拒绝原假设的次数</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>pearson_reject <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>spearman_reject <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>kendall_reject <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 模拟二元正态分布</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="dv">6</span>), <span class="dv">2</span>, <span class="dv">2</span>)  </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, sigma)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 进行相关性检验</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  pearson_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  kendall_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 检查是否拒绝原假设</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pearson_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) pearson_reject <span class="ot">&lt;-</span> pearson_reject <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (spearman_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) spearman_reject <span class="ot">&lt;-</span> spearman_reject <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (kendall_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) kendall_reject <span class="ot">&lt;-</span> kendall_reject <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二元正态分布下，拒绝原假设的次数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二元正态分布下，拒绝原假设的次数：</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson:&quot;</span>, pearson_reject, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson: 66</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman:&quot;</span>, spearman_reject, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman: 67</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall:&quot;</span>, kendall_reject, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall: 67</code></pre>
<p>可以看出，此时非参数检验的功效比person相关性检验高。</p>
</div>
<div id="section-7" class="section level2">
<h2>3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level. -What is the corresponding hypothesis test problem? - What test
should we use? Z-test, two-sample t-test, paired-t test or McNemar test?
Why? - Please provide the least necessary information for hypothesis
testing.</p>
<p>solution:</p>
<ol style="list-style-type: decimal">
<li>我们想检验两种方法的功率 (即效果)
是否存在显著差异，因此可以设定以下假设:</li>
</ol>
<p>原假设 <span class="math inline">\(\left(H_0\right)\)</span> :
两种方法的功率相等，即 <span class="math inline">\(p_1=p_2\)</span>
。</p>
<p>备择假设 <span class="math inline">\(\left(H_1\right)\)</span>
：两种方法的功率不相等，即 <span class="math inline">\(p_1 \neq
p_2\)</span> 。</p>
<ol start="2" style="list-style-type: decimal">
<li>选择Z-test。</li>
</ol>
<p>样本并不是完全独立的，数据由10000次实验在两种方法下产生；样本量大，样本量为
10,000
，足够大，可以使用Z检验来近似正态分布；功率可以视作某种比例，Z检验适合用于比较两个比例的情况。</p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(S
E=\sqrt{\frac{p_1\left(1-p_1\right)}{n_1}+\frac{p_2\left(1-p_2\right)}{n_2}},
Z=\frac{p_1-p_2}{S E}\)</span>。所以，知道<span class="math inline">\(p_1,p_2,n_1,n_2,\alpha\)</span>即可。</li>
</ol>
</div>
</div>
<div id="hw-4" class="section level1">
<h1>HW 4</h1>
<div id="section-8" class="section level2">
<h2>1</h2>
<p>Of <span class="math inline">\(N=1000\)</span> hypotheses, 950 are
null and 50 are alternative. The p-value under any null hypothesis is
uniformly distributed (use runif), and the p-value under any alternative
hypothesis follows the beta distribution with parameter 0.1 and 1 (use
rbeta). Obtain Bonferroni adjusted p-values and B-H adjusted p-values.
Calculate FWER, FDR, and TPR under nominal level <span class="math inline">\(\alpha=0.1\)</span> for each of the two adjustment
methods based on <span class="math inline">\(m=10000\)</span> simulation
replicates. You should output the 6 numbers (3) to a <span class="math inline">\(3 \times 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p>
<p>solution:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)  </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>null_hypotheses <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>alt_hypotheses <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 存储不同方法下的FWER、FDR 和 TPR</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 10000次模拟</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 生成 p 值</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(null_hypotheses), <span class="fu">rbeta</span>(alt_hypotheses, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bonferroni </span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  bonferroni_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  bonferroni_significant <span class="ot">&lt;-</span> bonferroni_p <span class="sc">&lt;</span> alpha</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B-H </span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  bh_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  bh_significant <span class="ot">&lt;-</span> bh_p <span class="sc">&lt;</span> alpha</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算 FWER,FDR,TPR</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  FWER_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_significant[<span class="dv">1</span><span class="sc">:</span>null_hypotheses])</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  FDR_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_significant) <span class="sc">/</span> <span class="fu">max</span>(<span class="dv">1</span>, <span class="fu">sum</span>(bonferroni_significant))</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  TPR_bonferroni <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_significant[(null_hypotheses <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> alt_hypotheses</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  FWER_BH <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_significant[<span class="dv">1</span><span class="sc">:</span>null_hypotheses])</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  FDR_BH <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_significant) <span class="sc">/</span> <span class="fu">max</span>(<span class="dv">1</span>, <span class="fu">sum</span>(bh_significant))</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  TPR_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_significant[(null_hypotheses <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> alt_hypotheses</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 累加</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> FWER_bonferroni</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">+</span> FDR_bonferroni</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results[<span class="dv">3</span>, <span class="dv">1</span>] <span class="sc">+</span> TPR_bonferroni</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> FWER_BH</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">2</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> FDR_BH</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  results[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> results[<span class="dv">3</span>, <span class="dv">2</span>] <span class="sc">+</span> TPR_BH</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">/</span> m</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER          9.863158e-05    0.003261053
## FDR           1.000000e-03    0.001000000
## TPR           4.002860e-01    0.563596000</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>2</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]:</p>
<p><span class="math display">\[
3,5,7,18,43,85,91,98,100,130,230,487 .
\]</span></p>
<p>Assume that the times between failures follow an exponential model
<span class="math inline">\(\operatorname{Exp}(\lambda)\)</span>. Obtain
the MLE of the hazard rate <span class="math inline">\(\lambda\)</span>
and use bootstrap to estimate the bias and standard error of the
estimate.</p>
<p>solution:</p>
<p>指数分布的概率密度函数为：</p>
<p><span class="math display">\[
f(x ; \lambda)=\lambda e^{-\lambda x} \quad(x \geq 0)
\]</span></p>
<p>对于独立同分布的样本 <span class="math inline">\(\$ x_1, x_2, ...,
x_n \$\)</span> ，似然函数为:</p>
<p><span class="math display">\[
L(\lambda)=\prod_{i=1}^n f\left(x_i ; \lambda\right)=\prod_{i=1}^n
\lambda e^{-\lambda x_i}=\lambda^n e^{-\lambda \sum_{i=1}^n x_i}
\]</span></p>
<p>对似然函数取对数得到对数似然函数：</p>
<p><span class="math display">\[
\log L(\lambda)=n \log \lambda-\lambda \sum_{i=1}^n x_i
\]</span></p>
<p><span class="math display">\[
\frac{d}{d \lambda} \log L(\lambda)=\frac{n}{\lambda}-\sum_{i=1}^n x_i=0
\]</span></p>
<p>解得：</p>
<p><span class="math display">\[
\hat{\lambda}=\frac{n}{\sum_{i=1}^n x_i}
\]</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算指数分布的MLE函数</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data) </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">lambda_mle</span>(data)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap估计偏差和标准误</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>bootstrap_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]  </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">lambda_mle</span>(sample_data))  </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)  </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, bootstrap_function, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算偏差和标准误</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_hat</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>std_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of λ:&quot;</span>, lambda_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of λ: 0.00925212</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bias:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bias: 0.001340736</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Error:&quot;</span>, std_error, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Error: 0.004377899</code></pre>
</div>
<div id="section-10" class="section level2">
<h2>3</h2>
<p>Compute <span class="math inline">\(95 \%\)</span> bootstrap
confidence intervals for the mean time between failures <span class="math inline">\(1 / \lambda\)</span> by the standard normal,
basic, percentile,Bca</p>
<p>solution:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 自助法函数，用于估计平均故障时间</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>mean_time_between_failures <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]  <span class="co"># 抽样</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  lambda_sample <span class="ot">&lt;-</span> <span class="fu">lambda_mle</span>(sample_data)  <span class="co"># 计算抽样的 λ</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> lambda_sample)  <span class="co"># 返回平均故障时间</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行自助法</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以保证可重复性</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, mean_time_between_failures, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 95% 自助法置信区间</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 标准正态法</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>mean_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t)  <span class="co"># 自助样本均值</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>std_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)  <span class="co"># 自助样本标准差</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>z_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)  <span class="co"># 正态分布的临界值</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> mean_estimate <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>z_value, z_value) <span class="sc">*</span> std_error  <span class="co"># 置信区间</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 基本法</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 百分位法</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_results<span class="sc">$</span>t, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. BCa 法</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出置信区间</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Interval (Normal):&quot;</span>, ci_normal, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% Confidence Interval (Normal): 33.7259 181.1135</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Interval (Basic):&quot;</span>, ci_basic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% Confidence Interval (Basic): 25.75417 170.0833</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Interval (Percentile):&quot;</span>, ci_percentile, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% Confidence Interval (Percentile): 46.08333 190.2542</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Interval (BCa):&quot;</span>, ci_bca, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% Confidence Interval (BCa): 56.16667 221.4406</code></pre>
</div>
</div>
<div id="class-work10-14" class="section level1">
<h1>class work(10-14)</h1>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>, <span class="fl">0.878</span>, <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>, <span class="fl">0.680</span>, <span class="fl">2.280</span>, <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2) <span class="sc">-</span> <span class="fu">mean</span>(d1)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap方法</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>bootstrap_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(data1, data2, <span class="at">R=</span><span class="dv">10000</span>) {</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(data1)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(data2)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  boot_diff <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>    resample1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(data1, n1, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    resample2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(data2, n2, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    boot_diff[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(resample2) <span class="sc">-</span> <span class="fu">mean</span>(resample1)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(boot_diff)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap抽样</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>boot_diff <span class="ot">&lt;-</span> <span class="fu">bootstrap_diff</span>(d1, d2)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap bias</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>bootstrap_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_diff) <span class="sc">-</span> mean</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap标准差</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>bootstrap_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_diff)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 样本标准差</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>obs_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(d1)<span class="sc">/</span><span class="fu">length</span>(d1) <span class="sc">+</span> <span class="fu">var</span>(d2)<span class="sc">/</span><span class="fu">length</span>(d2))</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;样本均值:&quot;</span>, mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 样本均值: 2.688836</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap偏差:&quot;</span>, bootstrap_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap偏差: 0.001780582</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始样本标准差:&quot;</span>, obs_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原始样本标准差: 0.7393791</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap标准差:&quot;</span>, bootstrap_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap标准差: 0.7118529</code></pre>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="section-11" class="section level2">
<h2>7.8</h2>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on
88 students who took examinations in five subjects. Each row of the data
frame is a set of scores <span class="math inline">\(\left(x_{i 1},
\ldots, x_{i 5}\right)\)</span> for the <span class="math inline">\(i^{t
h}\)</span> student. Efron and Tibshirani discuss the following example
. The five-dimensional scores data have a <span class="math inline">\(5
\times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In
principal components analysis,</p>
<p><span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{j=1}^5 \lambda_j}
\]</span></p>
<p>measures the proportion of variance explained by the first principal
component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\cdots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of
<span class="math inline">\(\Sigma\)</span>. Compute the sample
estimate</p>
<p><span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5 \hat{\lambda}_j}
\]</span></p>
<p>of <span class="math inline">\(\theta\)</span>. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>solution:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>hat_Sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>eigen_values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(hat_Sigma)<span class="sc">$</span>values</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>hat_theta <span class="ot">&lt;-</span> eigen_values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigen_values)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>jackknife_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 删除第 i 个观测</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    temp_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>i, ]</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    temp_Sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(temp_data)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    temp_eigen_values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(temp_Sigma)<span class="sc">$</span>values</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    theta_jack[i] <span class="ot">&lt;-</span> temp_eigen_values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(temp_eigen_values)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta_jack)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>jackknife_estimates <span class="ot">&lt;-</span> <span class="fu">jackknife_theta</span>(scor)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(jackknife_estimates) <span class="sc">-</span> hat_theta)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((jackknife_estimates <span class="sc">-</span> <span class="fu">mean</span>(jackknife_estimates))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="section-12" class="section level2">
<h2>7.10</h2>
<p>In Example 7.18 , leave-one-out ( <span class="math inline">\(n\)</span>-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>
?</p>
<p>cross validation procedure:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>        J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 将双对数模型换为三次多项式模型</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>      chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat4</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>可以看出，交叉验证选出模型为二次模型：</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    24.49262     -1.39334      0.05452</code></pre>
<p>maximum adjusted <span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a> r1 <span class="ot">&lt;-</span> r2 <span class="ot">&lt;-</span> r3 <span class="ot">&lt;-</span> r4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>   J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>   r1[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>   J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>   r2[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>   J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>   r3[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 将双对数模型换为三次多项式模型</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>   J4<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>   r4[k] <span class="ot">&lt;-</span> <span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">c</span>(<span class="fu">mean</span>(r1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(r4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.2789195 0.3326365 0.2789058 0.3293764</code></pre>
<p>可以看出，根据的最大调整选出模型为二次模型：</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    24.49262     -1.39334      0.05452</code></pre>
</div>
<div id="section-13" class="section level2">
<h2>8.1</h2>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<p>Example 8.1:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cramér-von Mises 统计量</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>cramer_von_mises_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)(<span class="fu">sort</span>(z))</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)(<span class="fu">sort</span>(z))</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">sum</span>((ecdf_x <span class="sc">-</span> ecdf_y)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (n1 <span class="sc">*</span> n2) <span class="sc">/</span> n</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> </span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算原始统计量</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>W0 <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises_stat</span>(x, y)</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 置换检验</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>  permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span>n1]</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> permuted[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n1 <span class="sc">+</span> n2)]</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises_stat</span>(x1, y1)</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W0, reps) <span class="sc">&gt;=</span> W0)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>p_value</span></code></pre></div>
<pre><code>## [1] 0.4</code></pre>
</div>
<div id="section-14" class="section level2">
<h2>8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function cor with method = “spearman”.
Compare the achieved significance level of the permutation test with the
p-value reported by cor.test on the same samples.</p>
<p>solution：</p>
<p>选取数据集为chickwts，xy分别为使用了葵花籽和亚麻籽的鸡群质量，不对质量进行排序。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chickwts&quot;</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>spearman_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>  </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)  </span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y) </span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)  </span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  permuted_z <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> permuted_z[<span class="dv">1</span><span class="sc">:</span>n1]</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> permuted_z[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n1 <span class="sc">+</span> n2)]</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>p_value_permutation <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(spearman_stat, reps) <span class="sc">&gt;=</span> spearman_stat)</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>p_value_permutation</span></code></pre></div>
<pre><code>## [1] 0.22</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cor.test p 值</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>p_value_cor_test <span class="ot">&lt;-</span> cor_test_result<span class="sc">$</span>p.value</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>p_value_cor_test</span></code></pre></div>
<pre><code>## [1] 0.4169384</code></pre>
<p>可以看出置换检验的p值更小。</p>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="section-15" class="section level2">
<h2>9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with <span class="math inline">\(\mathrm{df}=1\)</span> ). Recall that a Cauchy
<span class="math inline">\((\theta, \eta)\)</span> distribution has
density function</p>
<p><span class="math display">\[
f(x)=\frac{1}{\theta \pi\left(1+[(x-\eta) / \theta]^2\right)},
\quad-\infty&lt;x&lt;\infty, \theta&gt;0 .
\]</span></p>
<p>The standard Cauchy has the <span class="math inline">\(\operatorname{Cauchy}(\theta=1, \eta=0)\)</span>
density. (Note that the standard Cauchy density is equal to the Student
t density with one degree of freedom.)</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 柯西分布的密度函数</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>dcauchy_target <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>q_proposal <span class="ot">&lt;-</span> <span class="cf">function</span>(x_current, x_proposed, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 建议分布选择正态分布</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dnorm</span>(x_proposed, <span class="at">mean =</span> x_current, <span class="at">sd =</span> sigma))</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Metropolis-Hastings算法生成样本</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>mh_cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">burn_in =</span> <span class="dv">1000</span>, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">+</span> burn_in)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> burn_in)) {</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> sigma)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    target_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy_target</span>(proposal) <span class="sc">/</span> <span class="fu">dcauchy_target</span>(x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>    proposal_ratio <span class="ot">&lt;-</span> <span class="fu">q_proposal</span>(proposal, x[i <span class="sc">-</span> <span class="dv">1</span>], sigma) <span class="sc">/</span> <span class="fu">q_proposal</span>(x[i <span class="sc">-</span> <span class="dv">1</span>], proposal, sigma)</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, target_ratio <span class="sc">*</span> proposal_ratio)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> burn_in)])</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">mh_cauchy</span>(n)</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成样本的分位数</span></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 标准柯西分布的理论分位数</span></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>theoretical_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 分位数</span></span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Decile&#39;</span> <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Sample_Deciles&#39;</span> <span class="ot">=</span> sample_deciles,</span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Theoretical_Deciles&#39;</span> <span class="ot">=</span> theoretical_deciles</span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-46"><a href="#cb94-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##     Decile Sample_Deciles Theoretical_Deciles
## 10%    0.1    -2.52012351          -3.0776835
## 20%    0.2    -1.19169380          -1.3763819
## 30%    0.3    -0.64882084          -0.7265425
## 40%    0.4    -0.27910505          -0.3249197
## 50%    0.5     0.02697425           0.0000000
## 60%    0.6     0.33915239           0.3249197
## 70%    0.7     0.73120423           0.7265425
## 80%    0.8     1.31186734           1.3763819
## 90%    0.9     2.71779977           3.0776835</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 密度函数</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), sample_deciles, <span class="at">type =</span> <span class="st">&#39;b&#39;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Deciles&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Values&#39;</span>, <span class="at">main =</span> <span class="st">&#39;Sample vs Theoretical Deciles&#39;</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), theoretical_deciles, <span class="at">type =</span> <span class="st">&#39;b&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Sample Deciles&#39;</span>, <span class="st">&#39;Theoretical Deciles&#39;</span>),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="converge" class="section level2">
<h2>9.3 converge</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat R\ &lt;1.2\)</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>run_multiple_chains <span class="ot">&lt;-</span> <span class="cf">function</span>(num_chains, iter, burn_in, sigma) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    chains[[i]] <span class="ot">&lt;-</span> <span class="fu">mh_cauchy</span>(iter, burn_in, sigma)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  mcmc_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, mcmc))</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mcmc_chains)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span>       </span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>       </span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>           </span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>converged_n <span class="ot">&lt;-</span> <span class="cn">NA</span>     </span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>max_iterations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>r_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>()  <span class="co"># 每次迭代的 R2 </span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>()  </span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 寻找最先收敛的n</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">100</span>, max_iterations, <span class="at">by =</span> <span class="dv">1</span>)) {</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">run_multiple_chains</span>(num_chains, n, burn_in, sigma)</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  gelman_results <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(chains)</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(gelman_results<span class="sc">$</span>psrf[, <span class="st">&quot;Point est.&quot;</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>)) {</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Chains have converged at n =&quot;</span>, n, <span class="st">&quot;(R &lt; 1.2)!</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>    converged_n <span class="ot">&lt;-</span> n</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span>  </span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Chains have converged at n = 106 (R &lt; 1.2)!</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(converged_n)) {</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The chains first converged at n =&quot;</span>, converged_n, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The chains did not converge within the maximum iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## The chains first converged at n = 106</code></pre>
</div>
<div id="section-16" class="section level2">
<h2>9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, iter, burn_in) {</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  x_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  y_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  x_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  <span class="co"># 随机选择一个初值</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  y_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_chain[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x_chain[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iter) {</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    x_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_chain[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    y_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_chain[i] <span class="sc">+</span> a, n <span class="sc">-</span> x_chain[i] <span class="sc">+</span> b)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter], <span class="at">y =</span> y_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter]))</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span><span class="fu">gibbs_sampler</span> (a, b, n, iterations, burn_in)</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## [1] 5 3 7 4 6 5</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.5207254 0.4482047 0.3516535 0.6360829 0.5143220 0.4416378</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples<span class="sc">$</span>x, samples<span class="sc">$</span>y, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="converge-1" class="section level2">
<h2>9.8 converge</h2>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2456</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gibbs 采样函数</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, a, b, n) {</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_samples) {</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> y[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y1)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x1</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1 <span class="sc">+</span> a, n <span class="sc">-</span> x1 <span class="sc">+</span> b)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Gelman-Rubin 诊断函数</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(chains)  <span class="co"># 链数</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chains)  <span class="co"># 样本数</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>  means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(chains)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(means)</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(means)  <span class="co"># 序列间方差</span></span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(chains, <span class="dv">2</span>, var))  <span class="co"># 序列内方差</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_hat <span class="sc">/</span> W)  <span class="co"># 使用 sqrt 提供更标准的 Rhat</span></span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成多个链</span></span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>generate_chains <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n_chains, a, b, n) {</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>  chains_x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n_samples, n_chains)</span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>  chains_y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n_samples, n_chains)</span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(n_samples, a, b, n)</span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a>    chains_x[, i] <span class="ot">&lt;-</span> samples<span class="sc">$</span>x</span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a>    chains_y[, i] <span class="ot">&lt;-</span> samples<span class="sc">$</span>y</span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chains_x =</span> chains_x, <span class="at">chains_y =</span> chains_y))</span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-49"><a href="#cb106-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-50"><a href="#cb106-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 R_hat 并绘图</span></span>
<span id="cb106-51"><a href="#cb106-51" aria-hidden="true" tabindex="-1"></a>calculate_rhat_and_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n_chains, a, b, n) {</span>
<span id="cb106-52"><a href="#cb106-52" aria-hidden="true" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">generate_chains</span>(n_samples, n_chains, a, b, n)</span>
<span id="cb106-53"><a href="#cb106-53" aria-hidden="true" tabindex="-1"></a>  chains_x <span class="ot">&lt;-</span> chains<span class="sc">$</span>chains_x</span>
<span id="cb106-54"><a href="#cb106-54" aria-hidden="true" tabindex="-1"></a>  chains_y <span class="ot">&lt;-</span> chains<span class="sc">$</span>chains_y</span>
<span id="cb106-55"><a href="#cb106-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-56"><a href="#cb106-56" aria-hidden="true" tabindex="-1"></a>  R_hat_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb106-57"><a href="#cb106-57" aria-hidden="true" tabindex="-1"></a>  R_hat_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb106-58"><a href="#cb106-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-59"><a href="#cb106-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_samples) {</span>
<span id="cb106-60"><a href="#cb106-60" aria-hidden="true" tabindex="-1"></a>    R_hat_x[k] <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains_x[<span class="dv">1</span><span class="sc">:</span>k, ])</span>
<span id="cb106-61"><a href="#cb106-61" aria-hidden="true" tabindex="-1"></a>    R_hat_y[k] <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains_y[<span class="dv">1</span><span class="sc">:</span>k, ])</span>
<span id="cb106-62"><a href="#cb106-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-63"><a href="#cb106-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-64"><a href="#cb106-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 创建数据框以用于 ggplot</span></span>
<span id="cb106-65"><a href="#cb106-65" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-66"><a href="#cb106-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Iteration =</span> <span class="dv">1</span><span class="sc">:</span>n_samples,</span>
<span id="cb106-67"><a href="#cb106-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rhat_x =</span> R_hat_x,</span>
<span id="cb106-68"><a href="#cb106-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rhat_y =</span> R_hat_y</span>
<span id="cb106-69"><a href="#cb106-69" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb106-70"><a href="#cb106-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-71"><a href="#cb106-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 绘制 R_hat 曲线</span></span>
<span id="cb106-72"><a href="#cb106-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Iteration)) <span class="sc">+</span></span>
<span id="cb106-73"><a href="#cb106-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Rhat_x, <span class="at">color =</span> <span class="st">&quot;Rhat_x&quot;</span>)) <span class="sc">+</span></span>
<span id="cb106-74"><a href="#cb106-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Rhat_y, <span class="at">color =</span> <span class="st">&quot;Rhat_y&quot;</span>)) <span class="sc">+</span></span>
<span id="cb106-75"><a href="#cb106-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb106-76"><a href="#cb106-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Gelman-Rubin Diagnostic (Rhat) over Iterations&quot;</span>,</span>
<span id="cb106-77"><a href="#cb106-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Rhat&quot;</span>,</span>
<span id="cb106-78"><a href="#cb106-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;Chains&quot;</span></span>
<span id="cb106-79"><a href="#cb106-79" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb106-80"><a href="#cb106-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb106-81"><a href="#cb106-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)  <span class="co"># 加入收敛标准线</span></span>
<span id="cb106-82"><a href="#cb106-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-83"><a href="#cb106-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-84"><a href="#cb106-84" aria-hidden="true" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb106-85"><a href="#cb106-85" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>     </span>
<span id="cb106-86"><a href="#cb106-86" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb106-87"><a href="#cb106-87" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb106-88"><a href="#cb106-88" aria-hidden="true" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb106-89"><a href="#cb106-89" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb106-90"><a href="#cb106-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-91"><a href="#cb106-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算并绘制 Rhat</span></span>
<span id="cb106-92"><a href="#cb106-92" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_rhat_and_plot</span>(n_samples, n_chains, a, b, n)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="prrof" class="section level2">
<h2>Prrof</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p>Target pdf: <span class="math inline">\(f(x)\)</span>. Replace <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>. Proposal distribution (pdf): <span class="math inline">\(g(r \mid s)\)</span>. Acceptance probability:
<span class="math inline">\(\alpha(s, r)=\min \left\{\frac{f(r) g(s \mid
r)}{f(s) g(r \mid s)}, 1\right\}\)</span>. Transition kernel (mixture
distribution):</p>
<p><span class="math display">\[
K(r, s)=I(s \neq r) \alpha(r, s) g(s \mid r)+I(s=r)\left[1-\int
\alpha(r, s) g(s \mid r)\right]
\]</span></p>
<p>Stationarity: <span class="math inline">\(K(s, r) f(s)=K(r, s)
f(r)\)</span>.</p>
<p>solution:</p>
<p><span class="math inline">\(\mathrm{s}=\)</span> r时，</p>
<p><span class="math display">\[
K(r, s)=1-\int \alpha(r, s) g(s \mid r)\\=1-\int \min \left\{\frac{f(s)
g(r \mid s)}{f(r) g(s \mid r)}, 1\right\} g(s \mid
r)\\=1-g(s)=1-g(r)=K(s, r)
\]</span></p>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="section-17" class="section level2">
<h2>1</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{t
h}\)</span> term in</li>
</ol>
<p><span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\|a\|^{2 k+2}}{(2 k+1)(2
k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span></p>
<p>where <span class="math inline">\(d \geq 1\)</span> is an integer,
<span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span> ).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a=(1,2)^T\)</span>.</p></li>
</ol>
<p>solution:</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;pracma&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>compute_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  numerator_1 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k)  </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  numerator_2 <span class="ot">&lt;-</span> <span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))  </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  gamma_part <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  kth <span class="ot">&lt;-</span> numerator_1 <span class="sc">*</span> numerator_2 <span class="sc">*</span> gamma_part</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(kth)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(max_k, a, d) {</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>max_k) {</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    term_k <span class="ot">&lt;-</span> <span class="fu">compute_k</span>(k, a, d)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> term_k</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_sum</span>(<span class="dv">100</span>, a, d)</span></code></pre></div>
<pre><code>## [1] 1.813545</code></pre>
</div>
<div id="section-18" class="section level2">
<h2>2</h2>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)
\Gamma\left(\frac{k-1}{2}\right)}}
\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k / 2} d u \\
&amp; \quad=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_0^{c_k}\left(1+\frac{u^2}{k}\right)^{-(k+1) / 2} d u
\end{aligned}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where</p>
<p><span class="math display">\[
c_k=\sqrt{\frac{a^2 k}{k+1-a^2}} .
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>left_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(ck1, k) {</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, ck1)<span class="sc">$</span>value</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>right_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(ck, k) {</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, ck)<span class="sc">$</span>value</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  ck1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  ck  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  left <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">left_integral</span>(ck1, k)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>  right <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> k)) <span class="sc">*</span> <span class="fu">right_integral</span>(ck, k)</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(left <span class="sc">-</span> right)</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fu">sqrt</span>(k) <span class="sc">-</span> <span class="dv">1</span>), <span class="at">k =</span> k)</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行并输出结果</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>a_solution <span class="ot">&lt;-</span> <span class="fu">solve_for_a</span>(k)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;当 k =&quot;</span>, k, <span class="st">&quot;时，a 的解为：&quot;</span>, a_solution, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 当 k = 10 时，a 的解为： 1.625383</code></pre>
</div>
<div id="section-19" class="section level2">
<h2>3</h2>
<p>Suppose <span class="math inline">\(T_1, \ldots, T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i=T_i l\left(T_i \leq \tau\right)+\tau
l\left(T_i&gt;\tau\right)\)</span>, <span class="math inline">\(i=1,
\ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span>
and the observed <span class="math inline">\(Y_i\)</span> values are as
follows:</p>
<p><span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span></p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
<p>solution:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{E}: \, E\left[T_i \mid T_i &gt; \tau, \lambda\right] = \tau
+ \lambda \qquad Q^{(t)} = \sum_{Y_i &lt; \tau} Y_i + \sum_{Y_t = \tau}
\left(\tau + \lambda_t \right) \\
&amp; \text{M}: \, \lambda_{t+1} = \frac{Q^{(t)}}{n}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>uncensored <span class="ot">&lt;-</span> y <span class="sc">&lt;</span> tau</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>censored <span class="ot">&lt;-</span> y <span class="sc">==</span> tau</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>n_u <span class="ot">&lt;-</span> <span class="fu">sum</span>(uncensored)  <span class="co"># 未截尾数据个数</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>n_c <span class="ot">&lt;-</span> <span class="fu">sum</span>(censored)     <span class="co"># 截尾数据个数</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 初始lambda值，使用未截尾数据的均值作为初始值</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(y[uncensored])</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 迭代条件</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>lambda_diff <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co"># E-M 算法</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (iter <span class="sc">&lt;</span> max_iter <span class="sc">&amp;&amp;</span> lambda_diff <span class="sc">&gt;</span> tol) {</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># E步</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  E_T_censored <span class="ot">&lt;-</span> tau <span class="sc">+</span> lambda </span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M步</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> (<span class="fu">sum</span>(y[uncensored]) <span class="sc">+</span> n_c <span class="sc">*</span> E_T_censored) <span class="sc">/</span> (n_u <span class="sc">+</span> n_c)</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算收敛条件</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>  lambda_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;通过E-M算法估计的lambda值为:&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 通过E-M算法估计的lambda值为: 0.9642855</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;迭代次数:&quot;</span>, iter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 迭代次数: 12</code></pre>
<p>由均值为 <span class="math inline">\(\lambda\)</span> 可知， <span class="math inline">\(f(T)=\frac{1}{\lambda}
e^{-\frac{t}{\lambda}}\)</span></p>
<p><span class="math display">\[
\begin{aligned}
&amp; f(y)=\Pi_{i=1}^n\left[\frac{1}{\lambda} e^{-\frac{y_i}{\lambda}}
I\left\{0&lt;y_i&lt;1\right\}+e^{-\frac{1}{\lambda}}
I\left\{y_i=1\right\}\right] \qquad
l(y)=\sum_{i=1}^n\left[\left(-\frac{1}{\lambda} y_i-\log
(\lambda)\right) I\left\{0&lt;y_i&lt;1\right\}-\frac{1}{\lambda}
I\left\{y_i=1\right\}\right] \\
&amp; \text { 令 } \frac{\mathscr{O}(y)}{\partial y}=0 \text { 推出 }
\qquad\lambda=\frac{\sum_{t-1}^n y_i
I\left\{0&lt;y_i&lt;1\right\}+\sum_{t-1}^n
I\left\{y_i=1\right\}}{\sum_{t=1}^n I\left\{0&lt;y_i&lt;1\right\}}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算未截尾数据的和</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>sum_uncensored <span class="ot">&lt;-</span> <span class="fu">sum</span>(y[uncensored])</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> (sum_uncensored <span class="sc">+</span> n_c <span class="sc">*</span> tau) <span class="sc">/</span> (n_u )</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lambda值的MLE估计为:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## lambda值的MLE估计为: 0.9642857</code></pre>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="section-20" class="section level2">
<h2>11.7</h2>
<p>Use the simplex algorithm to solve the following problem.</p>
<p>最小化 <span class="math inline">\(4 x+2 y+9 z\)</span> 使得</p>
<p><span class="math display">\[
\begin{aligned}
&amp; 2 x+y+z \leq 2 \\
&amp; x-y+3 z \leq 3 \\
&amp; x \geq 0, y \geq 0, z \geq 0
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>ob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>constraints <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,  </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span> </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, ob, constraints, directions, rhs, <span class="at">compute.sens =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;最优解:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 最优解:</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;x =&quot;</span>, result<span class="sc">$</span>solution[<span class="dv">1</span>],<span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<pre><code>## x = 0 ;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;y =&quot;</span>, result<span class="sc">$</span>solution[<span class="dv">2</span>],<span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<pre><code>## y = 0 ;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;z =&quot;</span>, result<span class="sc">$</span>solution[<span class="dv">3</span>],<span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<pre><code>## z = 0 ;</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;最小值为：&quot;</span>, result<span class="sc">$</span>objval, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 最小值为： 0</code></pre>
</div>
<div id="section-21" class="section level2">
<h2>3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt,
mpg ~ I(1 / disp) + wt )</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    mpg <span class="sc">~</span> disp,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>loop_for <span class="ot">&lt;-</span> <span class="fu">list</span>()  </span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    loop_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>loop_for</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply() </span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>loop_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>loop_lapply</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-22" class="section level2">
<h2>4</h2>
<p>Fit the model mpg <span class="math inline">\(\sim\)</span> disp to
each of the bootstrap replicates of mtcars in the list below by using a
for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;-
sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)  </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    mtcars[rows, ]</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>loop_for4 <span class="ot">&lt;-</span> <span class="fu">list</span>()  </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    loop_for4[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>loop_for4</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.63818     -0.03569  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.99282     -0.03991  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47824     -0.03322  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.55956     -0.04022  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      29.256       -0.038  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.6163      -0.0397  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.67456     -0.03948  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.51112     -0.04023  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.76999     -0.03685  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.87171     -0.04224</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply() </span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>lapply4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_lm)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>lapply4</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.63818     -0.03569  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.99282     -0.03991  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.47824     -0.03322  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.55956     -0.04022  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##      29.256       -0.038  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##     29.6163      -0.0397  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.67456     -0.03948  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.51112     -0.04023  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.76999     -0.03685  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.87171     -0.04224</code></pre>
</div>
<div id="section-23" class="section level2">
<h2>5</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>rsq_for3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(loop_for))  </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(loop_for)) {</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    rsq_for3[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(loop_for[[i]])</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>rsq_for3</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>rsq_lapply3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(loop_lapply, rsq)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>rsq_lapply3</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>rsq_for4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(loop_for4))  </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(loop_for4)) {</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    rsq_for4[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(loop_for4[[i]])</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>rsq_for4</span></code></pre></div>
<pre><code>##  [1] 0.6608990 0.6211943 0.7305525 0.7598471 0.6797679 0.7098683 0.6818257
##  [8] 0.7775059 0.6433422 0.8018184</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>rsq_lapply4 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lapply4, rsq)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>rsq_lapply4</span></code></pre></div>
<pre><code>##  [1] 0.6608990 0.6211943 0.7305525 0.7598471 0.6797679 0.7098683 0.6818257
##  [8] 0.7775059 0.6433422 0.8018184</code></pre>
</div>
<div id="section-24" class="section level2">
<h2>3</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">45678</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>,</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(trial) trial<span class="sc">$</span>p.value)</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(p_values)</span></code></pre></div>
<pre><code>## [1] 0.4991439 0.7282356 0.7731799 0.3337447 0.1184589 0.4312053</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>p_values_direct</span></code></pre></div>
<pre><code>##   [1] 0.49914392 0.72823557 0.77317993 0.33374466 0.11845894 0.43120526
##   [7] 0.79921139 0.16825325 0.87757137 0.35788151 0.84617691 0.22624832
##  [13] 0.18524386 0.01417885 0.35219957 0.12056172 0.84125346 0.28872030
##  [19] 0.14105355 0.54693582 0.69947672 0.72156357 0.36012422 0.87901465
##  [25] 0.66009247 0.39142518 0.72195401 0.51540548 0.74728290 0.87874774
##  [31] 0.53150476 0.70159232 0.96532202 0.63351319 0.86895518 0.96718547
##  [37] 0.21638265 0.92113415 0.82035671 0.03945803 0.71861490 0.90740176
##  [43] 0.47781201 0.92182607 0.51746404 0.86518628 0.04805703 0.89480286
##  [49] 0.38976798 0.56151829 0.47964041 0.18946061 0.22448033 0.85966741
##  [55] 0.95752234 0.92672945 0.97077735 0.93010401 0.13229170 0.09257852
##  [61] 0.24255710 0.73959299 0.75480718 0.72375081 0.36151371 0.83899022
##  [67] 0.38183847 0.61953707 0.93148535 0.37622629 0.65453270 0.26513861
##  [73] 0.69232634 0.82575616 0.96080164 0.57681397 0.31070321 0.50754998
##  [79] 0.97607911 0.46087353 0.20822992 0.34615542 0.95643107 0.51832425
##  [85] 0.38287388 0.81993008 0.68863409 0.43660315 0.57468931 0.59534072
##  [91] 0.36792901 0.74109614 0.72595852 0.62171654 0.18137701 0.17544680
##  [97] 0.59362965 0.40779968 0.05943994 0.32918107</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(p_values, p_values_direct) </span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="section-25" class="section level2">
<h2>6</h2>
<p>Implement a combination of <span class="math inline">\(\operatorname{Map}()\)</span> and vapply() to
create an lapply() variant that iterates in parallel over all of its
inputs and stores its outputs in a vector (or a matrix). What arguments
should the function take?</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>map_vapply <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., FUN.VALUE) {</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(...)  </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    mapped <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)  </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vapply</span>(mapped, identity, FUN.VALUE)  </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>add <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) a <span class="sc">+</span> b</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">map_vapply</span>(add, x, y, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)  </span></code></pre></div>
<pre><code>## [1]  2  4  8 12 12 15 12 15</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>add_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) <span class="fu">c</span>(<span class="at">sum =</span> a <span class="sc">+</span> b, <span class="at">diff =</span> a <span class="sc">-</span> b)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>result_matrix <span class="ot">&lt;-</span> <span class="fu">map_vapply</span>(add_diff, x, y, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">2</span>))</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_matrix)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## sum     2    4    8   12   12   15   12   15
## diff    0    0   -2   -4   -2   -3    2    1</code></pre>
</div>
<div id="section-26" class="section level2">
<h2>4</h2>
<p>Make a faster version of chisq. test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en" class="uri">http://en</a>.
wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>fast_chisq_test1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    chisq_fast1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((tbl <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(chisq_fast1)</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>fast_chisq_test2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>    observed <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tbl)</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(expected)</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    chisq_fast2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed  <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(chisq_fast2)</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>chisq_fast1 <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test1</span>(x, y)</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_fast1) </span></code></pre></div>
<pre><code>## [1] 10.5</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>chisq_fast2 <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test2</span>(x, y)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_fast2) </span></code></pre></div>
<pre><code>## [1] 10.5</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test<span class="sc">$</span>statistic)  </span></code></pre></div>
<pre><code>## X-squared 
##      10.5</code></pre>
</div>
<div id="section-27" class="section level2">
<h2>5</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(x), <span class="fu">is.integer</span>(y))</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    unique_x <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    unique_y <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(unique_x), <span class="at">ncol =</span> <span class="fu">length</span>(unique_y))</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>        x_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(unique_x <span class="sc">==</span> x[i])</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        y_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(unique_y <span class="sc">==</span> y[i])</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>        tbl[x_idx, y_idx] <span class="ot">&lt;-</span> tbl[x_idx, y_idx] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dimnames</span>(tbl) <span class="ot">&lt;-</span> <span class="fu">list</span>(unique_x, unique_y)</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tbl)</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>    row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>    col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>    chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((tbl <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(chisq_stat)</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>tbl_fast <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tbl_fast)</span></code></pre></div>
<pre><code>##   3 2 1
## 3 1 0 2
## 1 0 1 0
## 2 3 0 0</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_stat)</span></code></pre></div>
<pre><code>## [1] 10.5</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test<span class="sc">$</span>statistic)  </span></code></pre></div>
<pre><code>## X-squared 
##      10.5</code></pre>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="section-28" class="section level2">
<h2>1</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical
Computing with R).</p>
<p>Consider the bivariate density</p>
<p><span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(Rcpp) </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix gibbs_sampler(int n, double a, double b, int num_samples, int burn_in) {</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="st">    NumericMatrix samples(num_samples, 2); </span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="st">    int x = 0; </span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="st">    double y = 0.5; </span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="st">    // Gibbs 采样</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="st">    for (int i = 0; i &lt; num_samples + burn_in; i++) {</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="st">        x = R::rbinom(n, y);</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="st">        y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="st">        if (i &gt;= burn_in) {</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="st">            samples(i - burn_in, 0) = x;</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="st">            samples(i - burn_in, 1) = y;</span></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a><span class="st">    return samples;</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>cppsamples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in)</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cppsamples[, <span class="dv">2</span>], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>)</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cppsamples[, <span class="dv">2</span>], <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&#39;y&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-29" class="section level2">
<h2>2</h2>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>rgibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, iter, burn_in) {</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  x_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  y_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  x_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  </span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  y_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_chain[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x_chain[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iter) {</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>    x_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_chain[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    y_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_chain[i] <span class="sc">+</span> a, n <span class="sc">-</span> x_chain[i] <span class="sc">+</span> b)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter], <span class="at">y =</span> y_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter]))</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>rsamples <span class="ot">&lt;-</span><span class="fu">rgibbs_sampler</span> (a, b, n, iterations, burn_in)</span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(cppsamples[, <span class="dv">1</span>], rsamples[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(cppsamples[, <span class="dv">2</span>], rsamples[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
## 3</p>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;microbenchmark&#39;</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c++ gibbs_sampler(n, a, b, num_samples, burn_in)</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># r rgibbs_sampler (a, b, n, iterations, burn_in)</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in), <span class="fu">rgibbs_sampler</span> (a, b, n, iterations, burn_in))</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time)</span></code></pre></div>
<pre><code>##                                           expr     min       lq      mean
## 1 gibbs_sampler(n, a, b, num_samples, burn_in)  2.3245  2.50095  2.575359
## 2 rgibbs_sampler(a, b, n, iterations, burn_in) 35.4098 40.59295 42.868776
##    median       uq      max neval cld
## 1  2.5565  2.62105   3.9271   100  a 
## 2 42.2024 43.81705 103.3189   100   b</code></pre>
<p>可以看出，用c++编写的函数计算时间远远比r编写的函数少，实验中选用c++进行某些函数计算可以提高实验效率。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
